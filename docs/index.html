<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<script src="https://kit.fontawesome.com/4eee35f757.js"></script>
<link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
<link rel="stylesheet" href="github.css" type="text/css">
<link rel="stylesheet" href="tutorial.css" type="text/css">
<script defer data-domain="gvwilson.github.io/sys-tutorial" src="https://plausible.io/js/script.js"></script>
<title>The Sudonomicon</title>

  </head>
  <body>
    <nav>
  <div class="row underline">
    <div class="col-2 left">
      <a class="navlink" href="#">Home</a>
    </div>
    <div class="col-10 right">
      <a href="https://github.com/gvwilson/sys-tutorial">repo</a>
      <a href="https://github.com/gvwilson/sys-tutorial/raw/main/sys-tutorial.zip">download</a>
      <a class="navlink" href="license/">license</a>
      <a class="navlink" href="conduct/">conduct</a>
      <a class="navlink" href="contributing/">contributing</a>
      <a class="navlink" href="colophon/">colophon</a>
    </div>
  </div>
</nav>

    <main>
      
  <h1>The Sudonomicon</h1>
  <p class="subtitle">Unix Systems for Weary Data Scientists</p>


      <div class="row">
  <div class="col-4 center">
    <img src="advent_05_356-resized.png" alt="cover art by Danielle Navarro" width="80%"/>
  </div>
  <div class="col-8">
    <p>
      Many think they know Unix.
      Few realize that what they know is just a shell.
      Beneath it lie mysteries both bewildering and wonderful:
      ports, processes, permissions,
      files that are not files,
      and components built atop other, older components
      that occasionally rise to the surface like ancient sea creatures believed long extinct.
    </p>
    <p>
      Like such creatures,
      Unix will outlive those who mock it.
      Welcome, then, to a world in which the strange will become familiar, and the familiar, strange.
      Welcome, thrice welcome, to Unix systems programming.
    </p>
    <p class="italic">
      "The Sudonomicon" is a <a href="https://third-bit.com/">Third Bit</a> production.
    </p>
  </div>
</div>

<!-- ---------------------------------------------------------------- -->
<section class="aside">
<h2 class="aside">What This Is</h2>
<ul>
<li>Notes and working examples that instructors can use to perform a lesson<ul>
<li>Do <em>not</em> expect novices with no prior Unix experience to be able to learn from them on their own</li>
</ul>
</li>
<li>Musical analogy<ul>
<li>This is the chord changes and melody</li>
<li>We expect instructors to create an arrangement and/or improvise while delivering</li>
</ul>
</li>
<li>Please see <a href="./license/">the license</a> for terms of use,
    the <a href="./conduct/">Code of Conduct</a> for community standards,
    and <a href="./contributing/">these guidelines</a> for notes on contributing</li>
<li><a href="https://third-bit.com/">Greg Wilson</a> is a programmer, author, and educator based in Toronto</li>
</ul>
<!-- ---------------------------------------------------------------- -->
</section>
<section class="aside">
<h2 class="aside">Scope</h2>
<ul>
<li><a href="http://teachtogether.tech/en/index.html#s:process-personas">Intended audience</a><ul>
<li>Ning did a bachelor&rsquo;s degree in economics
    and now works as a data analyst for the Ministry of Health</li>
<li>They are comfortable working with Unix command-line tools,
    writing data analysis programs in Python,
and downloading data from the web manually</li>
<li>Ning wants to understand what happens when they install a package
or run a pipeline in the cloud</li>
<li>Their work schedule is unpredictable and highly variable,
    so they need to be able to learn a bit at a time</li>
</ul>
</li>
<li>Prerequisites<ul>
<li>Unix shell commands covered in <a href="https://swcarpentry.github.io/shell-novice/">this Software Carpentry lesson</a>:<ul>
<li><code>pwd</code>; <code>ls</code>; <code>cd</code>; <code>.</code> and <code>..</code>; <code>rm</code> and <code>rmdir</code>; <code>mkdir</code>; <code>touch</code>;
    <code>mv</code>; <code>cp</code>; <code>tree</code>; <code>cat</code>; <code>wc</code>; <code>head</code>; <code>tail</code>; <code>less</code>; <code>cut</code>; <code>echo</code>;
    <code>history</code>; <code>find</code>; <code>grep</code>; <code>zip</code>; <code>man</code></li>
<li>current working directory; absolute and relative paths; naming files;
    editing with <code>nano</code></li>
<li>standard input; standard output; standard error; redirection; pipes</li>
<li><code>*</code> and <code>?</code> wildcards; shell variable with <code>$</code> expansion; <code>for</code> loop</li>
</ul>
</li>
<li>Python for command-line scripting<ul>
<li>variables; numbers and strings; lists; dictionaries; <code>for</code> and <code>while</code> loops;
<code>if</code>/<code>else</code>; <code>with</code>; defining and calling functions; <code>sys.argv</code>, <code>sys.stdin</code>,
and <code>sys.stdout</code>; simple regular expressions; reading JSON data;
reading CSV files using <a href="https://pandas.pydata.org/">Pandas</a> or <a href="https://pola.rs/">Polars</a></li>
<li><code>pip install</code></li>
</ul>
</li>
<li><code>python -m venv</code> or <code>conda create</code></li>
</ul>
</li>
<li>Learning outcomes<ol>
<li>Explain the difference between shell variables and environment variables
    and write shell scripts that use each.</li>
<li>Create a virtual environment and explain what this actually does.</li>
<li>Create <code>requirements.txt</code> file for <a href="https://pip.pypa.io/en/stable/"><code>pip</code></a> and explain version pinning.</li>
<li>Explain what a filesystem is (disk partitions, inodes, symbolic links)
    and use <code>df</code>, <code>ln</code>, similar commands to explore with them.</li>
<li>Explain what a process is and use commands like <code>ps</code> and <code>kill</code> to explore and manage them.</li>
<li>Explain what a job is and use commands like <code>jobs</code>, <code>bg</code>, and <code>fg</code> to manage them.</li>
<li>Explain what <code>cron</code> jobs are and how to create them.</li>
<li>Explain the difference between a container and a virtual machine.</li>
<li>Create and manage Docker images.</li>
<li>Explain what ports are and write Python code that uses sockets and HTTP.</li>
<li>Explain what certificates are and how they are used to support HTTPS.</li>
<li>Explain what key pairs are and how they are stored, and create and manage key pairs.</li>
<li>Explain what IP addresses are and how they are resolved.</li>
<li>Explain how traditional password authentication works and describe its weaknesses.</li>
</ol>
</li>
</ul>
<!-- ---------------------------------------------------------------- -->
</section>
<section class="aside">
<h2 class="aside">Setup</h2>
<ul>
<li>Download <a href="https://github.com/gvwilson/sys-tutorial/raw/main/sys-tutorial.zip">the latest release</a></li>
<li>Unzip the file in a temporary directory to create:<ul>
<li><code>./site/*.*</code>: files and directories used in examples</li>
<li><code>./src/*.*</code>: shell scripts and Python programs</li>
<li><code>./out/*.*</code>: expected output for examples</li>
</ul>
</li>
</ul>
<!-- ---------------------------------------------------------------- -->
</section>
<section class="topic">
<h2 class="topic">1: Operating System vs. Shell</h2>
<ul>
<li>OS is…</li>
<li>Shell is…</li>
<li>Many different shells</li>
<li><p class="center"><span class="todo">TODO: how to tell what shell you are using</span></p></li>
</ul>
<!-- ---------------------------------------------------------------- -->
</section>
<section class="topic">
<h2 class="topic">2: Program vs. Process</h2>
<ul>
<li>A program is…</li>
<li>A <a href="#g:process">process</a> is a running instance of a program<ul>
<li>Code plus variables in memory plus open files plus some IDs</li>
</ul>
</li>
<li>Tools to manage them were invented when most users only had a single terminal</li>
</ul>
<!-- ---------------------------------------------------------------- -->
</section>
<section class="topic">
<h2 class="topic">3: Viewing Processes</h2>
<ul>
<li>Use <code>ps -a -l</code> to see currently running processes in terminal<ul>
<li><code>UID</code>: numeric ID of the user that the process belongs to</li>
<li><code>PID</code>: process&rsquo;s unique ID</li>
<li><code>PPID</code>: ID of the process&rsquo;s parent (i.e., the process that created it)</li>
<li><code>CMD</code>: the command the process is running</li>
</ul>
</li>
</ul>
<p class="inclusion"><a href="src/ps_a_l.sh">src/ps_a_l.sh</a></p>
<div class="language-sh">
<div class="highlight"><pre><span></span><code>ps<span class="w"> </span>-a<span class="w"> </span>-l
</code></pre></div>
</div>
<p class="inclusion"><a href="out/ps_a_l.out">out/ps_a_l.out</a></p>
<div class="language-plaintext">
<div class="highlight"><pre><span></span><code>UID   PID  PPID        F CPU PRI NI        SZ    RSS       TTY       TIME CMD
    0 13215 83470     4106   0  31  0 408655632   9504   ttys001    0:00.02 login -pfl gvwilson /
  501 13216 13215     4006   0  31  0 408795632   5424   ttys001    0:00.04 -bash
  501 13569 13216     4046   0  31  0 408895008  20864   ttys001    0:00.10 python -m http.server
    0 13577 13216     4106   0  31  0 408766128   1888   ttys001    0:00.01 ps -a -l
</code></pre></div>
</div>
<ul>
<li>Use <code>ps -a -x</code> to see (almost) all processes running on computer<ul>
<li><code>ps -a -x | wc</code> tells me there are 655 processes running on my laptop right now</li>
</ul>
</li>
</ul>
<!-- ---------------------------------------------------------------- -->
</section>
<section class="exercise">
<h2 class="exercise">Practice</h2>
<p><strong>Exercise 1</strong>:
What does the <code>top</code> command do?
What does <code>top -o cpu</code> do?</p>
<p><strong>Exercise 2</strong>:
What does the <code>pgrep</code> command do?</p>
<!-- ---------------------------------------------------------------- -->
</section>
<section class="topic">
<h2 class="topic">4: Parent and Child Processes</h2>
<ul>
<li>Every process is created by another process<ul>
<li>Except the first</li>
</ul>
</li>
<li>Refer to <a href="#g:process_child">child process</a> and <a href="#g:process_parent">parent process</a></li>
<li><code>echo $$</code> shows <a href="#g:process_id">process ID</a> of current process<ul>
<li><code>$$</code> shortcut because it&rsquo;s used so often</li>
</ul>
</li>
<li><code>echo $PPID</code> (parent process ID) to get parent</li>
<li><code>pstree $$</code> to see <a href="#g:process_tree">process tree</a></li>
</ul>
<!-- ---------------------------------------------------------------- -->
</section>
<section class="topic">
<h2 class="topic">5: Shell Variables vs. Environment Variables</h2>
<ul>
<li>The shell is a program and programs have variables</li>
<li><a href="#g:shell_var">Shell variable</a> stays in the process</li>
<li><a href="#g:env_var">Environment variable</a> is inherited by new processes</li>
</ul>
<p class="inclusion"><a href="src/shell_vs_env_outer.sh">src/shell_vs_env_outer.sh</a></p>
<div class="language-sh">
<div class="highlight"><pre><span></span><code><span class="c1"># shell_vs_env_outer.sh</span>
<span class="nv">window</span><span class="o">=</span><span class="s2">&quot;neighbor&quot;</span>
<span class="nv">threshold</span><span class="o">=</span><span class="m">0</span>.5

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;outer: window is </span><span class="si">${</span><span class="nv">window</span><span class="si">}</span><span class="s2"> and threshold is </span><span class="si">${</span><span class="nv">threshold</span><span class="si">}</span><span class="s2">&quot;</span>
bash<span class="w"> </span>src/shell_vs_env_inner.sh
</code></pre></div>
</div>
<p class="inclusion"><a href="src/shell_vs_env_inner.sh">src/shell_vs_env_inner.sh</a></p>
<div class="language-sh">
<div class="highlight"><pre><span></span><code><span class="c1"># shell_vs_env_inner.sh</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;inner: window is </span><span class="si">${</span><span class="nv">window</span><span class="si">}</span><span class="s2"> and threshold is </span><span class="si">${</span><span class="nv">threshold</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
</div>
<p class="inclusion"><a href="out/shell_vs_env_outer.out">out/shell_vs_env_outer.out</a></p>
<div class="language-plaintext">
<div class="highlight"><pre><span></span><code>outer: window is neighbor and threshold is 0.5
inner: window is  and threshold is
</code></pre></div>
</div>
<!-- ---------------------------------------------------------------- -->
</section>
<section class="exercise">
<h2 class="exercise">Practice</h2>
<p><strong>Exercise 3</strong>:
If a child process sets shell or environment variables,
are they visible in the parent once the child finishes executing?</p>
<!-- ---------------------------------------------------------------- -->
</section>
<section class="topic">
<h2 class="topic">6: Signals</h2>
<ul>
<li>Can send a <a href="#g:signal">signal</a> to a process<ul>
<li>Something extraordinary happened, please deal with it immediately</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align: right;">Number</th>
<th>Name</th>
<th>Default Action</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">1</td>
<td><code>SIGHUP</code></td>
<td>terminate process</td>
<td>terminal line hangup</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td><code>SIGINT</code></td>
<td>terminate process</td>
<td>interrupt program</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td><code>SIGQUIT</code></td>
<td>create core image</td>
<td>quit program</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td><code>SIGILL</code></td>
<td>create core image</td>
<td>illegal instruction</td>
</tr>
<tr>
<td style="text-align: right;">8</td>
<td><code>SIGFPE</code></td>
<td>create core image</td>
<td>floating-point exception</td>
</tr>
<tr>
<td style="text-align: right;">9</td>
<td><code>SIGKILL</code></td>
<td>terminate process</td>
<td>kill program</td>
</tr>
<tr>
<td style="text-align: right;">11</td>
<td><code>SIGSEGV</code></td>
<td>create core image</td>
<td>segmentation violation</td>
</tr>
<tr>
<td style="text-align: right;">12</td>
<td><code>SIGSYS</code></td>
<td>create core image</td>
<td>non-existent system call invoked</td>
</tr>
<tr>
<td style="text-align: right;">14</td>
<td><code>SIGALRM</code></td>
<td>terminate process</td>
<td>real-time timer expired</td>
</tr>
<tr>
<td style="text-align: right;">15</td>
<td><code>SIGTERM</code></td>
<td>terminate process</td>
<td>software termination signal</td>
</tr>
<tr>
<td style="text-align: right;">17</td>
<td><code>SIGSTOP</code></td>
<td>stop process</td>
<td>stop (cannot be caught or ignored)</td>
</tr>
<tr>
<td style="text-align: right;">24</td>
<td><code>SIGXCPU</code></td>
<td>terminate process</td>
<td>CPU time limit exceeded</td>
</tr>
<tr>
<td style="text-align: right;">25</td>
<td><code>SIGXFSZ</code></td>
<td>terminate process</td>
<td>file size limit exceeded</td>
</tr>
</tbody>
</table>
<ul>
<li>Create a <a href="#g:callback_function">callback function</a> to act as a <a href="#g:signal_handler">signal handler</a></li>
</ul>
<p class="inclusion"><a href="src/catch_interrupt.py">src/catch_interrupt.py</a></p>
<div class="language-py">
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">signal</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="n">COUNT</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">handler</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">COUNT</span>
    <span class="n">COUNT</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;interrupt </span><span class="si">{</span><span class="n">COUNT</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">COUNT</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">signal</span><span class="o">.</span><span class="n">signal</span><span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">SIGINT</span><span class="p">,</span> <span class="n">handler</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;use Ctrl-C three times&quot;</span><span class="p">)</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">signal</span><span class="o">.</span><span class="n">pause</span><span class="p">()</span>
</code></pre></div>
</div>
<p class="inclusion"><a href="out/catch_interrupt.out">out/catch_interrupt.out</a></p>
<div class="language-plaintext">
<div class="highlight"><pre><span></span><code>python src/catch_interrupt.py
use Ctrl-C three times
^Cinterrupt 1
^Cinterrupt 2
^Cinterrupt 3
</code></pre></div>
</div>
<ul>
<li><code>^C</code> shows where user typed Ctrl-C</li>
</ul>
<!-- ---------------------------------------------------------------- -->
</section>
<section class="topic">
<h2 class="topic">7: Background Processes</h2>
<ul>
<li>Can run a process in the <a href="#g:process_background">background</a><ul>
<li>Only difference is that it&rsquo;s not connected to the terminal</li>
</ul>
</li>
</ul>
<p class="inclusion"><a href="src/show_timer.py">src/show_timer.py</a></p>
<div class="language-py">
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">time</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;loop </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;loop finished&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
<p class="inclusion"><a href="src/show_timer.sh">src/show_timer.sh</a></p>
<div class="language-sh">
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>src/show_timer.py<span class="w"> </span><span class="p">&amp;</span>
ls<span class="w"> </span>site
</code></pre></div>
</div>
<p class="inclusion"><a href="out/show_timer.out">out/show_timer.out</a></p>
<div class="language-plaintext">
<div class="highlight"><pre><span></span><code>$ src/show_timer.sh
birds.csv       cert_authority.srl  sandbox         server.pem      species.csv
cert_authority.key  motto.json      server.csr      server_first_cert.pem   yukon.db
cert_authority.pem  motto.txt       server.key      server_first_key.pem
loop 0
$ loop 1
loop 2
loop finished
</code></pre></div>
</div>
<ul>
<li><code>&amp;</code> at end of command to run <code>show_timer.py</code> means &ldquo;run in the background&rdquo;</li>
<li>So <code>ls</code> command executes immediately</li>
<li>But <code>show_timer.py</code> keeps running until it finishes<ul>
<li>Or needs keyboard input</li>
</ul>
</li>
<li>Can also start process and then <a href="#g:process_suspend">suspend</a> it with Ctrl-Z<ul>
<li>Sends <code>SIGSTOP</code> instead of <code>SIGINT</code></li>
</ul>
</li>
<li>Use <code>jobs</code> to see all suspended processes</li>
<li>Then <code>bg %<em>num</em></code> to resume in the background</li>
<li>Or <code>fg %<em>num</em></code> to <a href="#g:process_foreground">foreground</a> the process
    to <a href="#g:process_resume">resume</a> its execution</li>
</ul>
<p class="inclusion"><a href="src/ctrl_z_background.text">src/ctrl_z_background.text</a></p>
<div class="language-text">
<div class="highlight"><pre><span></span><code>$ python src/show_timer.py
loop 0
^Z
[1]+  Stopped                 python src/show_timer.py
$ jobs
[1]+  Stopped                 python src/show_timer.py
$ bg
[1]+ python src/show_timer.py &amp;
loop 1
$ loop 2
loop finished
[1]+  Done                    python src/show_timer.py
</code></pre></div>
</div>
<ul>
<li>Note that input and output are mixed together</li>
</ul>
<!-- ---------------------------------------------------------------- -->
</section>
<section class="topic">
<h2 class="topic">8: Killing Processes</h2>
<ul>
<li>Use <code>kill</code> to send a signal to a process<ul>
<li>Not necessarily to stop it</li>
</ul>
</li>
</ul>
<p class="inclusion"><a href="src/kill_process.text">src/kill_process.text</a></p>
<div class="language-text">
<div class="highlight"><pre><span></span><code>$ python src/show_timer.py
loop 0
^Z
[1]+  Stopped                 python src/show_timer.py
$ kill %1
[1]+  Terminated: 15          python src/show_timer.py
</code></pre></div>
</div>
<ul>
<li>By default, <code>kill</code> sends <code>SIGTERM</code> (terminate process)</li>
<li>Variations:<ul>
<li>Give a process ID: <code>kill 1234</code></li>
<li>Send a different signal: <code>kill -s INT %1</code></li>
</ul>
</li>
</ul>
<p class="inclusion"><a href="src/kill_int.text">src/kill_int.text</a></p>
<div class="language-text">
<div class="highlight"><pre><span></span><code>$ python src/show_timer.py
loop 0
^Z
[1]+  Stopped                 python src/show_timer.py
$ kill -s INT %1
[1]+  Stopped                 python src/show_timer.py
$ fg
python src/show_timer.py
Traceback (most recent call last):
  File &quot;/tut/sys/src/show_timer.py&quot;, line 5, in &lt;module&gt;
    time.sleep(1)
KeyboardInterrupt
</code></pre></div>
</div>
<!-- ---------------------------------------------------------------- -->
</section>
<section class="topic">
<h2 class="topic">9: Fork</h2>
<ul>
<li><a href="#g:fork">Fork</a> creates a duplicate of a process<ul>
<li>Creator is parent, gets process ID of child as return value</li>
<li>Child gets 0 as return value (but has something else as its process ID)</li>
</ul>
</li>
</ul>
<p class="inclusion"><a href="src/fork.py">src/fork.py</a></p>
<div class="language-py">
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">os</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;starting </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">pid</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">fork</span><span class="p">()</span>
<span class="k">if</span> <span class="n">pid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;child got </span><span class="si">{</span><span class="n">pid</span><span class="si">}</span><span class="s2"> is </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parent got </span><span class="si">{</span><span class="n">pid</span><span class="si">}</span><span class="s2"> is </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
<p class="inclusion"><a href="out/fork.out">out/fork.out</a></p>
<div class="language-plaintext">
<div class="highlight"><pre><span></span><code>starting 41618
parent got 41619 is 41618
child got 0 is 41619
</code></pre></div>
</div>
<!-- ---------------------------------------------------------------- -->
</section>
<section class="topic">
<h2 class="topic">10: Flushing I/O</h2>
<ul>
<li>Example above works interactively</li>
<li>Run as <code>python fork.py &gt; temp.out</code>, the &ldquo;starting&rdquo; line is duplicated</li>
<li><p class="center"><span class="todo">TODO: explain I/O flushing</span></p></li>
</ul>
<p class="inclusion"><a href="src/flush.py">src/flush.py</a></p>
<div class="language-py">
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;starting </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
<span class="n">pid</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">fork</span><span class="p">()</span>
<span class="k">if</span> <span class="n">pid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;child got </span><span class="si">{</span><span class="n">pid</span><span class="si">}</span><span class="s2"> is </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parent got </span><span class="si">{</span><span class="n">pid</span><span class="si">}</span><span class="s2"> is </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
<!-- ---------------------------------------------------------------- -->
</section>
<section class="topic">
<h2 class="topic">11: Exec</h2>
<ul>
<li>The <code>exec</code> family of functions in <code>os</code> execute a new program <em>inside the calling process</em><ul>
<li>Replace existing program and start a new one</li>
</ul>
</li>
<li>So <code>fork</code>/<code>exec</code> to run a program</li>
</ul>
<p class="inclusion"><a href="src/fork_exec.py">src/fork_exec.py</a></p>
<div class="language-py">
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;starting </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
<span class="n">pid</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">fork</span><span class="p">()</span>
<span class="k">if</span> <span class="n">pid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">execl</span><span class="p">(</span><span class="s2">&quot;/bin/echo&quot;</span><span class="p">,</span> <span class="s2">&quot;echo&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;child echoing </span><span class="si">{</span><span class="n">pid</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parent got </span><span class="si">{</span><span class="n">pid</span><span class="si">}</span><span class="s2"> is </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
<p class="inclusion"><a href="out/fork_exec.out">out/fork_exec.out</a></p>
<div class="language-plaintext">
<div class="highlight"><pre><span></span><code>starting 46713
parent got 46714 is 46713
child echoing 0 from 46714
</code></pre></div>
</div>
<!-- ---------------------------------------------------------------- -->
</section>
<section class="exercise">
<h2 class="exercise">Practice</h2>
<p><strong>Exercise 4</strong>:
What are the differences between <code>os.execl</code>, <code>os.execlp</code>, and <code>os.execv</code>?</p>
<!-- ---------------------------------------------------------------- -->
</section>
<section class="aside">
<h2 class="aside">Appendices</h2>
<h3>Terms</h3>
<dl class="glossary">
<dt id="g:ascii">ASCII character encoding</dt><dd>A standard way to represent the characters commonly used in the Western European languages as 7-bit integers, now largely superceded by <a href="#unicode">Unicode</a>.</dd>

<dt id="g:authentication">authentication</dt><dd>The act of establishing one&rsquo;s identity.</dd>

<dt id="g:authorization">authorization</dt><dd>The act of establishing that one has a right to access certain information.</dd>

<dt id="g:process_background">background a process</dt><dd>To disconnect a <a href="#process">process</a> from the terminal but keep it running.</dd>

<dt id="g:base64">base64 encoding</dt><dd>A representation of binary data that represents each group of 6 bits as one of 64 printable characters.</dd>

<dt id="g:block">block</dt><dd>A set of bytes of a fixed size.</dd>

<dt id="g:block_device">block device</dt><dd>An I/O interface that reads or writes fixed-size <a href="#block">blocks</a>.</dd>

<dt id="g:callback_function">callback function</dt><dd>A function A that is passed to another function B so that B can call it at some later point.</dd>

<dt id="g:certificate_authority">certificate authority (CA)</dt><dd>An organization that issues, stores, and <a href="#digital_signature">signs</a> <a href="#digital_certificate">digital certificates</a>.</dd>

<dt id="g:character_encoding">character encoding</dt><dd>A way to represent characters as bytes. Common examples include <a href="#ascii">ASCII</a> and <a href="#utf_8">UTF-8</a>.</dd>

<dt id="g:cleartext">cleartext</dt><dd>Text that has not been <a href="#encryption">encrypted</a>.</dd>

<dt id="g:client">client</dt><dd>A program such as a browser that sends requests to a server and does something with the response.</dd>

<dt id="g:concurrency">concurrency</dt><dd>The ability of different parts of a system to take action at the same time.</dd>

<dt id="g:deployment">deployment</dt><dd>The act of making software available for use, e.g., by distributing it as package or by running a <a href="#service">service</a>.</dd>

<dt id="g:digital_certificate">digital certificate</dt><dd>A file containing a <a href="#public_key_crypto">public cryptography key</a> and potentially other information such as the owner&rsquo;s email address or an expiration date. Digital certificates are used to establish identity online.</dd>

<dt id="g:digital_signature">digital signature</dt><dd>A means of establishing the authenticity of a message or document.</dd>

<dt id="g:dynamic_content">dynamic content</dt><dd>Web site content that is generated on the fly. Dynamic content is usually customized according to the requester&rsquo;s identity, <a href="#query_parameter">query parameter</a>, etc.</dd>

<dt id="g:encryption">encryption</dt><dd>The process of converting data from a representation that anyone can read to one that can only be read by someone with the right algorithm and/or key.</dd>

<dt id="g:process_foreground">foreground a process</dt><dd>To reconnect a <a href="#process">process</a> to the terminal after it has been <a href="#process_background">backgrounded</a> or <a href="#process_suspend">suspended</a>.</dd>

<dt id="g:fragility">fragility</dt><dd>Used to describe a system that only works correctly if everything goes well; the opposite of <a href="#robustness">robust</a>.</dd>

<dt id="g:http_header">header (of HTTP request or response)</dt><dd>A name-value pair at the start of an <a href="#http_request">HTTP request</a> or <a href="#http_response">response</a>. Headers are used to specify what data formats the sender can handle, the date and time the message was sent, and so on.</dd>

<dt id="g:hostname">hostname</dt><dd>A human-readable name for a computer on a network.</dd>

<dt id="g:http">HTTP</dt><dd>The protocol used to exchange information between browsers and websites, and more generally between other clients and servers. Communication consists of <a href="#http_request">requests</a> and <a href="#http_response">responses</a>.</dd>

<dt id="g:http_method">HTTP method</dt><dd>The verb in an <a href="#http_request">HTTP request</a> that defines what the <a href="#client">client</a> wants to do. Common methods are <code>GET</code> (to get data) and <code>POST</code> (to submit data).</dd>

<dt id="g:http_request">HTTP request</dt><dd>A precisely-formatted block of text sent from a <a href="#client">client</a> such as a browser to a <a href="#server">server</a> that specifies what resource is being requested, what data formats the client will accept, etc.</dd>

<dt id="g:http_response">HTTP response</dt><dd>A precisely-formatted block of text sent from a <a href="#server">server</a> back to a <a href="#client">client</a> in reply to a <a href="#http_request">request</a>.</dd>

<dt id="g:http_status_code">HTTP status code</dt><dd>A numerical code that indicates what happened when an <a href="#http_request">HTTP request</a> was processed, such as 200 (OK), 404 (not found), or 500 (internal server error).</dd>

<dt id="g:https">HyperText Transfer Protocol Secure (HTTPS)</dt><dd>An encrypted version of <a href="#http">HTTP</a> used for secure communication.</dd>

<dt id="g:json">JavaScript Object Notation (JSON)</dt><dd>A way to represent data by combining basic values like numbers and character strings in lists and key-value structures. Unlike other formats, it is unencumbered by a syntax for writing comments.</dd>

<dt id="g:local_server">local server</dt><dd>A <a href="#server">server</a> running on the programmer&rsquo;s own computer, typically for development purposes.</dd>

<dt id="g:localhost">localhost</dt><dd>A special <a href="#hostname">host name</a> that identifies the computer that the software is running on.</dd>

<dt id="g:mime_type">MIME type</dt><dd>A standard that defines types of file content, such as <code>text/plain</code> for plain text and <code>image/jpeg</code> for JPEG images.</dd>

<dt id="g:path">path (in filesystem)</dt><dd>An expression that refers to a file or directory in a filesystem.</dd>

<dt id="g:pipe_shell">pipe</dt><dd>To use the output of one computation as the input for the next, or the connection between the two computations responsible for the data transfer.</dd>

<dt id="g:port">port</dt><dd>A logical endpoint for communication, like a phone number in an office building.</dd>

<dt id="g:process">process</dt><dd>A running instance of a program.</dd>

<dt id="g:public_key_crypto">public key cryptography</dt><dd>A way to encrypt data in which each key undoes the effect of the other, but it is practically impossible to determine one key given the other.</dd>

<dt id="g:query_parameter">query parameter</dt><dd>A key-value pair included in a URL that the server may use to modify or customize its response.</dd>

<dt id="g:refactor">refactor</dt><dd>To reorganize code without changing its overall behavior.</dd>

<dt id="g:resolve_path">resolve (a path)</dt><dd>To translate a <a href="#path">path</a> into the canonical name of the file or directory it refers to.</dd>

<dt id="g:process_resume">resume a process</dt><dd>To continue the execution of a <a href="#process_suspend">suspended</a> <a href="#process">process</a>.</dd>

<dt id="g:robustness">robustness</dt><dd>The ability to cope with errors or unlikely events while executing; the opposite of <a href="#fragility">fragile</a>.</dd>

<dt id="g:server">server</dt><dd>A program that waits for requests from <a href="#client">clients</a> and sends them data in response.</dd>

<dt id="g:service">service</dt><dd>A long-running program that provides functionality to other programs (or people). A service may run on a local computer for personal use, or may be networked for wider use.</dd>

<dt id="g:signal">signal</dt><dd>A message sent to a running <a href="#process">process</a> separate from its normal execution, such as an interrupt or a timer notification.</dd>

<dt id="g:signal_handler">signal handler</dt><dd>A <a href="#callback_function">callback function</a> that is called when a <a href="#process">process</a> receives a <a href="#signal">signal</a>.</dd>

<dt id="g:socket">socket</dt><dd>A communication channel between two computers that provides an interface similar to reading and writing files.</dd>

<dt id="g:stderr">standard error</dt><dd>A predefined communication channel typically used to report errors.</dd>

<dt id="g:stdin">standard input</dt><dd>A predefined communication channel typically used to read input from the keyboard or from the previous process in a <a href="#pipe_shell">pipe</a>.</dd>

<dt id="g:stdout">standard output</dt><dd>A predefined communication channel typically used to send output to the screen or to the next process in a <a href="#pipe_shell">pipe</a>.</dd>

<dt id="g:static_file">static file</dt><dd>Web site content that is stored as a file on disk that is served as-is. Serving static files is usually faster than generating <a href="#dynamic_content">dynamic content</a>, but can only be done if what&rsquo;s wanted is unchanging and known in advance.</dd>

<dt id="g:stream">stream</dt><dd>A sequence of bytes or other data of variable length that can only be processed in sequential order.</dd>

<dt id="g:process_suspend">suspend a process</dt><dd>To pause the execution of a <a href="#process">process</a> but leave it intact so that it can <a href="#process_resume">resume</a> later.</dd>

<dt id="g:tls_ssl">Transport Layer Security/Secure Sockets Layer (TLS/SSL)</dt><dd>A cryptographic protocol for secure communication over a computer network.</dd>

<dt id="g:unicode">Unicode</dt><dd>A standard that defines numeric codes for many thousands of characters and symbols. Unicode does not define how those numbers are stored; that is done by standards like <a href="#utf_8">UTF-8</a>.</dd>

<dt id="g:utf_8">UTF-8</dt><dd>A way to store the numeric codes representing <a href="#unicode">Unicode</a> characters that is backward-compatible with the older <a href="#ascii">ASCII</a> standard.</dd>

<dt id="g:web_scraping">web scraping</dt><dd>The act of extracting data from HTML pages on the web.</dd>

<dt id="g:wrap_object">wrap (an object)</dt><dd>To replace an object in a program with one that has the same external interface but which behaves differently or performs extra operations.</dd>
</dl>
<h3>Acknowledgments</h3>
<ul><li>Stefan Arentz</li>
<li>Julia Evans</li>
<li>Robert Kern</li>
<li>Matt Panaro</li>
<li>Jean-Marc Saffroy</li>
</ul>
<h3>Links</h3>
<ul>
<li><em>Teaching Tech Together</em>: <a href="https://teachtogether.tech/">https://teachtogether.tech/</a></li>
<li><em>Teaching Tech Together</em> lesson on learner personas: <a href="http://teachtogether.tech/en/index.html#s:process-personas">http://teachtogether.tech/en/index.html#s:process-personas</a></li>
<li>Basic HTTP authentication: <a href="https://en.wikipedia.org/wiki/Basic_access_authentication">https://en.wikipedia.org/wiki/Basic_access_authentication</a></li>
<li>Open Notify API for the International Space Station: <a href="http://api.open-notify.org/">http://api.open-notify.org/</a></li>
<li>Pandas dataframe library: <a href="https://pandas.pydata.org/">https://pandas.pydata.org/</a></li>
<li>Polars dataframe library: <a href="https://pola.rs/">https://pola.rs/</a></li>
<li>Python <code>http.server</code> module: <a href="https://docs.python.org/3/library/http.server.html">https://docs.python.org/3/library/http.server.html</a></li>
<li>Python <code>urllib.parse</code> module: <a href="https://docs.python.org/3/library/urllib.parse.html">https://docs.python.org/3/library/urllib.parse.html</a></li>
<li>Software Carpentry lesson on Git: <a href="https://swcarpentry.github.io/git-novice/">https://swcarpentry.github.io/git-novice/</a></li>
<li>Software Carpentry lesson on the Unix shell: <a href="https://swcarpentry.github.io/shell-novice/">https://swcarpentry.github.io/shell-novice/</a></li>
<li>The Carpentries: <a href="https://carpentries.org/">https://carpentries.org/</a></li>
<li>Wikipedia article on HTTP status codes: <a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes">https://en.wikipedia.org/wiki/List_of_HTTP_status_codes</a></li>
<li><code>requests</code> module: <a href="https://requests.readthedocs.io/en/latest/">https://requests.readthedocs.io/en/latest/</a></li>
<li>netcat: <a href="https://en.wikipedia.org/wiki/Netcat">https://en.wikipedia.org/wiki/Netcat</a></li>
<li>pip package manager for Python: <a href="https://pip.pypa.io/en/stable/">https://pip.pypa.io/en/stable/</a></li>
</ul>
<h3>To Do</h3>
<ul>
<li>What is Docker and why do I care?<ul>
<li>Introduce it early so people don&rsquo;t screw up their laptop</li>
</ul>
</li>
<li>How can I find things on my system?<ul>
<li><code>find | xargs</code> and alternatives</li>
</ul>
</li>
<li>What is <code>sudo</code> and when should I use it?</li>
<li>How can I found out what kind of system I&rsquo;m using (<code>uname</code>)</li>
<li>How do I see who has accounts on a machine?</li>
<li>How do I create a new account?</li>
<li>How do I delete an account?</li>
<li>How do I see who owns a file?</li>
<li>What does it actually mean to own a file?</li>
<li>What other kinds of permissions are there?</li>
<li>How can I specify what program to use to run a file?</li>
<li>How can I tell what kind of file a file is?</li>
<li>How can I see what&rsquo;s using a computer&rsquo;s processor/memory/disk/network?</li>
<li>How are files and directories stored (i.e., what is an inode)?</li>
<li>How can I see how much disk space is in use (<code>df</code>, <code>du</code>)?</li>
<li>When is a file not a file?</li>
<li>How can I create a shortcut (link) for a file?</li>
<li>What is a port?</li>
<li>How can I tell which ports are being used and by which processes?</li>
<li>How can I run a job repeatedly (<code>cron</code> and <code>watch</code>)?</li>
<li>What is a process group?</li>
<li>What are keys and how do I manage them?</li>
<li>What are certificates and how do I manage them?</li>
<li>How can I run a web server?</li>
<li>What other services might I want to run, when, and why?</li>
<li>How can I change my identity (sudo)?</li>
<li>How can I check my network connection (ping, traceroute)?</li>
<li>What is an IP address?</li>
<li>How can I connect to another computer (ssh)?</li>
<li>What is a user group and why do I care?</li>
<li>How can I view the computer&rsquo;s system log and what will I find there?</li>
<li>What are virtual environments and when would I use one?</li>
<li>How does package installation work?<ul>
<li>For Unix and for Python and why they are different</li>
</ul>
</li>
<li>How does authentication work?</li>
<li>What are alternatives to classic password authentication?</li>
</ul>
</section>
    </main>
    <footer>
  <i class="fa fa-copyright"></i> 2024 Greg Wilson
  &middot;
  <a href="mailto:gvwilson@third-bit.com"><i class="fas fa-envelope-square" aria-hidden="true" title="author email"></i></a>
  <a href="https://github.com/gvwilson/sys-tutorial"><i class="fab fa-github" aria-hidden="true" title="GitHub repository"></i></a>
  <a href="license/"><i class="fab fa-creative-commons-by" aria-hidden="true" title="license"></i></a>
  &middot;
  <i class="fas fa-clock"></i>
  <time datetime="2024-03-15">Last built 2024-03-15</time>
  &middot;
  <i class="fas fa-user-check"></i> 100% human content
</footer>

  </body>
</html>
