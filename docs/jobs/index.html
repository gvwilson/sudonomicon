<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" href="../logo.svg">
<link rel="stylesheet" href="../tango.css" type="text/css">
<link rel="stylesheet" href="../mccole.css" type="text/css">
<title>The Sudonomicon &middot; Running Jobs</title>
<script>
  MathJax = {
    tex: {
      inlineMath: [['\\(', '\\)']]
    }
  };
</script>
<script
  type="text/javascript"
  id="MathJax-script"
  async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>

  <script defer data-domain="gvwilson.github.io/sys-tutorial" src="https://plausible.io/js/plausible.js"></script>


  </head>
  <body>
    <main>
      <div class="row notex">
  <div class="col-12 center">
    
      <h1>Running Jobs</h1>
    
  </div>
</div>

      
<nav class="row-always notex">
  <div class="col-1 left">
    <a href="../proc/" title="previous" class="undecorated">&#8678;</a>
  </div>
  <div class="col-10 center">
    <a href="../" title="home" class="undecorated">&#9737;</a>
  </div>
  <div class="col-1 right">
    <a href="../http/" title="next" class="undecorated">&#8680;</a>
  </div>
</nav>


      
      
      <ul>
<li>Computers don&rsquo;t get bored, so get them to do boring things</li>
</ul>
<h2 id="jobs-watch">Watching a Command</h2>
<ul>
<li>The <code>watch</code> command runs a command periodically and displays result<ul>
<li>Hard to show output statically…</li>
</ul>
</li>
</ul>
<div class="language-text" title="watch_date.text">
<div class="highlight"><pre><span></span><code>$ watch -n 5 date
Every 5.0s: date              cherne: Mon Apr 22 16:11:48 2024

Mon Apr 22 16:11:53 EDT 2024
</code></pre></div>
</div>
<ul>
<li><code>-n 5</code>: every five seconds</li>
<li>Less distracting to show without title (<code>-t</code>)</li>
</ul>
<div class="language-text" title="watch_date_no_title.text">
<div class="highlight"><pre><span></span><code>$ watch -t -n 5 date
Mon Apr 22 16:11:53 EDT 2024
</code></pre></div>
</div>
<ul>
<li>More useful to show differences with <code>-d</code></li>
<li>Each successive update highlights the difference from the previous one<ul>
<li>Again, hard to show statically</li>
</ul>
</li>
<li>Also use to use <code>-g</code> to exit when the command&rsquo;s output changes</li>
<li>E.g., <code>watch -n 1 -g netstat</code> will exit within one second of network activity</li>
</ul>
<h2 id="jobs-fswatch">Watching Files</h2>
<ul>
<li>Use <code>fswatch</code> (file system watch)</li>
</ul>
<div class="language-text" title="fswatch_example.text">
<div class="highlight"><pre><span></span><code>$ fswatch -l 1 -x Created -x Removed /tmp

# touch /tmp/a.txt
/private/tmp/a.txt Created IsFile

# rm /tmp/a.txt
/private/tmp/a.txt Created IsFile Removed
</code></pre></div>
</div>
<ul>
<li><code>-l 1</code>: latency of one second (i.e., how often to report)</li>
<li><code>-x Created -x Removed</code>: what events to watch for</li>
<li><code>/tmp</code>: look for any changes in this directory</li>
<li>Get one line per change<ul>
<li>Common to pipe the output of <code>fswatch</code> to something that parses these lines and acts on them</li>
</ul>
</li>
<li><p class="fixme">FIXME: why does removing the file generate a &lsquo;Created&rsquo; record?</p></li>
</ul>
    </main>
    <footer>
  © 2024 <a href="https://third-bit.com/">Greg Wilson</a>
  &middot;
  <a href="../">home</a>
  &middot;
  <a href="https://github.com/gvwilson/sys-tutorial">repository</a>
  &middot;
  <a href="../license/">license</a>
</footer>

  </body>
</html>
