outer: window is neighbor and threshold is 0.5
inner: window is  and threshold is 
